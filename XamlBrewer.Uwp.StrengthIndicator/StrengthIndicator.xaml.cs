using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Diagnostics;
using Windows.UI;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Data;
using Windows.UI.Xaml.Media;

namespace XamlBrewer.Uwp.Controls
{
    public partial class StrengthIndicator : UserControl
    {
        private const int Minimum = 0;

        private int _pathIndex = 0;

        public static readonly DependencyProperty MaximumProperty = DependencyProperty.Register("Maximum", typeof(int), typeof(StrengthIndicator), new PropertyMetadata(5));
        public static readonly DependencyProperty ValueProperty = DependencyProperty.Register("Value", typeof(int), typeof(StrengthIndicator), new PropertyMetadata(0, OnValueChanged));
        public static readonly DependencyProperty FillProperty = DependencyProperty.Register("Fill", typeof(Brush), typeof(StrengthIndicator), new PropertyMetadata(new SolidColorBrush(Colors.Black)));
        public static readonly DependencyProperty StrokeProperty = DependencyProperty.Register("Stroke", typeof(Brush), typeof(StrengthIndicator), new PropertyMetadata(new SolidColorBrush(Colors.OrangeRed)));

        public StrengthIndicator()
        {
            InitializeComponent();

            Paths = DefaultPaths;
            Debug.WriteLine("Constructed with {0} Paths.", Paths.Count);

            Paths.CollectionChanged += Paths_CollectionChanged;
            Loaded += StrengthIndicator_Loaded;
        }

        private void Paths_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
        {
            _pathIndex = Paths.Count - 1;

            Debug.WriteLine("Paths collections changed, added {0} to {2} with {1}.", (sender as ObservableCollection<string>).Count, e.NewItems[0], Paths.Count);

            Paths.CollectionChanged -= Paths_CollectionChanged;
            Value = 0;
            OnValueChanged(this);
        }

        public int Maximum
        {
            get { return (int)GetValue(MaximumProperty); }
            set { SetValue(MaximumProperty, value); }
        }

        public int Value
        {
            get { return (int)GetValue(ValueProperty); }
            set { SetValue(ValueProperty, value); }
        }

        public ObservableCollection<String> Paths
        {
            get; set;
        }

        public Brush Fill
        {
            get { return (Brush)GetValue(FillProperty); }
            set { SetValue(FillProperty, value); }
        }

        public Brush Stroke
        {
            get { return (Brush)GetValue(StrokeProperty); }
            set { SetValue(StrokeProperty, value); }
        }

        // Created by NOPIXEL from the Noun Project
        private static ObservableCollection<String> DefaultPaths
        {
            get
            {
                return new ObservableCollection<String>
                {
                    "m 72.772,54.758 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z m -6.371,4.539 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 6.371,-12.539 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z m 0,8 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z m -0.5,3.5 c -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.277 -0.223,-0.5 -0.5,-0.5 z m -5.013,3.95 c -0.224,-0.163 -0.357,-0.424 -0.357,-0.699 l 0,-0.712 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,0.712 c 0,0.595 0.288,1.159 0.771,1.509 0.088,0.064 0.19,0.095 0.293,0.095 0.154,0 0.308,-0.072 0.405,-0.207 0.162,-0.223 0.111,-0.536 -0.112,-0.698 z m 5.513,-23.45 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z m -6.371,8.539 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 5.371,-6.539 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m 1,10 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z M 66.401,35.297 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-0.306 c 0,-0.37 0.235,-0.698 0.585,-0.817 0.262,-0.089 0.401,-0.373 0.313,-0.634 -0.09,-0.262 -0.373,-0.403 -0.635,-0.312 -0.755,0.256 -1.263,0.965 -1.263,1.763 l 0,0.306 c 0,0.276 0.224,0.5 0.5,0.5 z m 2.51,32.074 2,0 c 0.414,0 0.806,-0.133 1.133,-0.384 0.219,-0.168 0.26,-0.482 0.092,-0.701 -0.17,-0.22 -0.484,-0.26 -0.701,-0.092 -0.151,0.116 -0.332,0.177 -0.523,0.177 l -2,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.223,0.5 0.499,0.5 z m 0.406,-33.742 1.594,0 c 0.087,0 0.173,0.013 0.254,0.038 0.049,0.015 0.099,0.022 0.146,0.022 0.214,0 0.412,-0.138 0.479,-0.354 0.08,-0.264 -0.068,-0.544 -0.332,-0.625 -0.177,-0.054 -0.36,-0.082 -0.547,-0.082 l -1.594,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.224,0.501 0.5,0.501 z m -2.916,21.668 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 6.371,-16.539 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 z m -6.371,0.539 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m -4.316,13.411 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m -5.357,6.669 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 0,8 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 4.561,2.994 -2,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.224,0.5 0.5,0.5 l 2,0 c 0.421,0 0.831,-0.149 1.152,-0.419 0.212,-0.177 0.239,-0.493 0.062,-0.704 -0.177,-0.212 -0.493,-0.24 -0.704,-0.062 -0.143,0.119 -0.323,0.185 -0.51,0.185 z m 0.796,-5.663 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m 0,4 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m -4.488,1.539 C 57.366,66.1 57.228,65.849 57.228,65.576 l 0,-0.698 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,0.698 c 0,0.617 0.312,1.184 0.832,1.515 0.083,0.053 0.176,0.078 0.269,0.078 0.165,0 0.326,-0.082 0.422,-0.231 0.147,-0.234 0.078,-0.543 -0.154,-0.691 z m -0.869,-14.87 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 5.857,-6.169 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.277 0.224,0.5 0.5,0.5 z m -0.5,3.5 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m -5.357,-1.331 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 4.734,-3.692 c 0.36,0.08 0.623,0.407 0.623,0.777 l 0,0.247 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-0.247 c 0,-0.835 -0.592,-1.573 -1.408,-1.753 -0.27,-0.058 -0.536,0.111 -0.596,0.38 -0.06,0.269 0.11,0.536 0.381,0.596 z m 0.623,17.023 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z M 57.581,39.743 c 0.057,0 0.115,-0.01 0.172,-0.03 0.086,-0.031 0.153,-0.041 0.271,-0.047 l 1.549,0 c 0.276,0 0.5,-0.224 0.5,-0.5 0,-0.276 -0.224,-0.5 -0.5,-0.5 l -1.547,0 c -0.211,0.002 -0.419,0.036 -0.616,0.107 -0.259,0.095 -0.393,0.382 -0.298,0.641 0.074,0.204 0.265,0.329 0.469,0.329 z m -4.677,25.485 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z M 47.047,47.365 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-0.395 c 0,-0.34 0.215,-0.646 0.535,-0.759 0.261,-0.092 0.396,-0.378 0.305,-0.638 -0.093,-0.26 -0.378,-0.396 -0.639,-0.304 -0.719,0.254 -1.201,0.938 -1.201,1.701 l 0,0.395 c 0,0.276 0.224,0.5 0.5,0.5 z m 2.86,-1.699 1.693,0 c 0.063,0 0.127,0.007 0.189,0.022 0.038,0.009 0.077,0.014 0.115,0.014 0.227,0 0.432,-0.155 0.486,-0.384 0.064,-0.269 -0.103,-0.539 -0.371,-0.602 -0.137,-0.033 -0.278,-0.049 -0.42,-0.049 l -1.692,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.224,0.499 0.5,0.499 z m 2.997,15.562 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m -5.857,6.137 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,-8 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 5.857,-6.137 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m -5.857,10.137 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 2.553,8.006 2,0 c 0.412,0 0.815,-0.143 1.136,-0.402 0.215,-0.173 0.248,-0.488 0.074,-0.703 -0.173,-0.214 -0.488,-0.247 -0.703,-0.074 -0.145,0.117 -0.32,0.179 -0.507,0.179 l -2,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.223,0.5 0.5,0.5 z m 3.304,-14.143 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m -4.991,13.014 c -0.229,-0.149 -0.366,-0.401 -0.366,-0.675 l 0,-0.702 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,0.702 c 0,0.613 0.307,1.179 0.821,1.513 0.084,0.055 0.179,0.081 0.272,0.081 0.163,0 0.323,-0.08 0.419,-0.228 0.151,-0.231 0.086,-0.541 -0.146,-0.691 z M 47.047,51.365 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m -4.931,0.348 c 0.356,0.089 0.605,0.409 0.606,0.776 l 0,0.277 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-0.278 c -0.003,-0.827 -0.563,-1.544 -1.362,-1.745 -0.273,-0.069 -0.54,0.096 -0.607,0.363 -0.066,0.269 0.096,0.54 0.363,0.607 z m 0.607,13.054 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z M 38.25,51.757 c 0.053,0 0.106,-0.008 0.159,-0.026 0.083,-0.028 0.169,-0.042 0.257,-0.042 l 1.577,0 c 0.276,0 0.5,-0.224 0.5,-0.5 0,-0.276 -0.224,-0.5 -0.5,-0.5 l -1.577,0 c -0.196,0 -0.39,0.032 -0.575,0.094 -0.262,0.088 -0.402,0.372 -0.314,0.633 0.07,0.209 0.264,0.341 0.473,0.341 z m 3.673,14.614 -2,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.224,0.5 0.5,0.5 l 2,0 c 0.398,0 0.775,-0.127 1.092,-0.369 0.219,-0.167 0.262,-0.481 0.094,-0.701 -0.169,-0.22 -0.481,-0.261 -0.701,-0.094 -0.14,0.107 -0.308,0.164 -0.485,0.164 z m 1.3,-9.104 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m -5.532,9.817 c 0.084,0.054 0.178,0.08 0.271,0.08 0.164,0 0.325,-0.081 0.42,-0.229 0.15,-0.232 0.083,-0.542 -0.149,-0.691 -0.229,-0.148 -0.367,-0.399 -0.366,-0.673 l 0,-0.7 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,0.699 c -0.002,0.615 0.306,1.181 0.824,1.514 z M 37.366,59.37 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 0,-8 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 z m 5.357,5.397 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z m -15.038,2.621 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.223,0.5 0.5,0.5 z m 0,-4 c 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-0.316 c 0,-0.355 0.239,-0.668 0.583,-0.761 0.267,-0.072 0.424,-0.346 0.352,-0.613 -0.071,-0.267 -0.342,-0.426 -0.613,-0.352 -0.777,0.21 -1.321,0.92 -1.321,1.726 l 0,0.316 c -0.001,0.276 0.222,0.5 0.499,0.5 z m 0.341,7.711 c 0.082,0.052 0.174,0.076 0.265,0.076 0.166,0 0.329,-0.083 0.424,-0.235 0.146,-0.234 0.075,-0.543 -0.159,-0.689 -0.232,-0.146 -0.371,-0.396 -0.371,-0.668 l 0,-0.695 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,0.695 c 0,0.62 0.314,1.187 0.841,1.516 z m 2.228,0.272 2,0 c 0.318,0 0.631,-0.084 0.903,-0.245 0.238,-0.14 0.318,-0.446 0.179,-0.685 -0.142,-0.239 -0.45,-0.318 -0.685,-0.178 -0.119,0.07 -0.257,0.107 -0.397,0.107 l -2,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.224,0.501 0.5,0.501 z m 0.378,-9.588 1.622,0 c 0.078,0 0.154,0.011 0.227,0.033 0.049,0.015 0.098,0.021 0.146,0.021 0.215,0 0.413,-0.139 0.479,-0.354 0.08,-0.264 -0.068,-0.543 -0.333,-0.624 -0.167,-0.05 -0.341,-0.076 -0.518,-0.076 l -1.622,0 c -0.276,0 -0.5,0.224 -0.5,0.5 0,0.276 0.222,0.5 0.499,0.5 z m 2.91,4.642 c -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 z m -0.5,-1.5 c 0,0.276 0.224,0.5 0.5,0.5 0.276,0 0.5,-0.224 0.5,-0.5 l 0,-2 c 0,-0.276 -0.224,-0.5 -0.5,-0.5 -0.276,0 -0.5,0.224 -0.5,0.5 l 0,2 z",
                    "m 67.784,67.871 3.148,0 c 1.302,0 2.362,-1.06 2.362,-2.362 l 0,-31.018 c 0,-1.302 -1.06,-2.362 -2.362,-2.362 l -3.148,0 c -1.302,0 -2.362,1.06 -2.362,2.362 l 0,31.018 c 0,1.302 1.06,2.362 2.362,2.362 z m -0.362,-33.38 c 0,-0.2 0.162,-0.362 0.362,-0.362 l 3.148,0 c 0.2,0 0.362,0.162 0.362,0.362 l 0,31.018 c 0,0.2 -0.162,0.362 -0.362,0.362 l -3.148,0 c -0.2,0 -0.362,-0.162 -0.362,-0.362 l 0,-31.018 z m -9.378,33.38 3.266,0 c 1.266,0 2.295,-1.03 2.295,-2.295 l 0,-25.114 c 0,-1.266 -1.03,-2.296 -2.295,-2.296 l -3.266,0 c -1.266,0 -2.296,1.03 -2.296,2.296 l 0,25.113 c 0.001,1.266 1.03,2.296 2.296,2.296 z M 57.749,40.462 c 0,-0.163 0.133,-0.296 0.296,-0.296 l 3.266,0 c 0.163,0 0.295,0.133 0.295,0.296 l 0,25.113 c 0,0.163 -0.132,0.295 -0.295,0.295 l -3.266,0 c -0.163,0 -0.296,-0.132 -0.296,-0.295 l 0,-25.113 z m -9.377,27.409 3.25,0 c 1.271,0 2.304,-1.033 2.304,-2.304 l 0,-19.097 c 0,-1.271 -1.034,-2.304 -2.304,-2.304 l -3.25,0 c -1.271,0 -2.304,1.034 -2.304,2.304 l 0,19.097 c 0,1.27 1.033,2.304 2.304,2.304 z M 48.068,46.47 c 0,-0.168 0.136,-0.304 0.304,-0.304 l 3.25,0 c 0.168,0 0.304,0.136 0.304,0.304 l 0,19.097 c 0,0.167 -0.136,0.304 -0.304,0.304 l -3.25,0 c -0.167,0 -0.304,-0.136 -0.304,-0.304 l 0,-19.097 z m -9.38,21.401 3.256,0 c 1.269,0 2.3,-1.032 2.3,-2.3 l 0,-13.081 c 0,-1.269 -1.032,-2.3 -2.3,-2.3 l -3.256,0 c -1.269,0 -2.3,1.032 -2.3,2.3 l 0,13.08 c -10e-4,1.269 1.031,2.301 2.3,2.301 z M 38.387,52.49 c 0,-0.166 0.135,-0.3 0.3,-0.3 l 3.256,0 c 0.166,0 0.3,0.135 0.3,0.3 l 0,13.08 c 0,0.166 -0.135,0.3 -0.3,0.3 l -3.256,0 c -0.166,0 -0.3,-0.135 -0.3,-0.3 l 0,-13.08 z m -9.393,15.381 3.281,0 c 1.262,0 2.288,-1.026 2.288,-2.288 l 0,-7.012 c 0,-1.262 -1.026,-2.288 -2.288,-2.288 l -3.281,0 c -1.262,0 -2.288,1.026 -2.288,2.288 l 0,7.012 c 0,1.261 1.026,2.288 2.288,2.288 z",
                    "m 67.782,67.871 3.147,0 c 1.302,0 2.362,-1.06 2.362,-2.362 l 0,-31.018 c 0,-1.302 -1.06,-2.362 -2.362,-2.362 l -3.147,0 c -1.302,0 -2.362,1.06 -2.362,2.362 l 0,31.018 c 0,1.302 1.06,2.362 2.362,2.362 z M 67.42,34.491 c 0,-0.2 0.162,-0.362 0.362,-0.362 l 3.147,0 c 0.2,0 0.362,0.162 0.362,0.362 l 0,31.018 c 0,0.2 -0.162,0.362 -0.362,0.362 l -3.147,0 c -0.2,0 -0.362,-0.162 -0.362,-0.362 l 0,-31.018 z m -9.378,33.38 3.266,0 c 1.266,0 2.295,-1.03 2.295,-2.295 l 0,-25.114 c 0,-1.266 -1.03,-2.296 -2.295,-2.296 l -3.266,0 c -1.266,0 -2.296,1.03 -2.296,2.296 l 0,25.113 c 0,1.266 1.03,2.296 2.296,2.296 z M 57.746,40.462 c 0,-0.163 0.133,-0.296 0.296,-0.296 l 3.266,0 c 0.163,0 0.295,0.133 0.295,0.296 l 0,25.113 c 0,0.163 -0.132,0.295 -0.295,0.295 l -3.266,0 c -0.163,0 -0.296,-0.132 -0.296,-0.295 l 0,-25.113 z m -9.377,27.409 3.25,0 c 1.271,0 2.304,-1.033 2.304,-2.304 l 0,-19.097 c 0,-1.271 -1.034,-2.304 -2.304,-2.304 l -3.25,0 c -1.271,0 -2.304,1.034 -2.304,2.304 l 0,19.097 c 0,1.27 1.034,2.304 2.304,2.304 z M 48.065,46.47 c 0,-0.168 0.136,-0.304 0.304,-0.304 l 3.25,0 c 0.168,0 0.304,0.136 0.304,0.304 l 0,19.097 c 0,0.167 -0.136,0.304 -0.304,0.304 l -3.25,0 c -0.167,0 -0.304,-0.136 -0.304,-0.304 l 0,-19.097 z m -9.38,21.401 3.256,0 c 1.269,0 2.3,-1.032 2.3,-2.3 l 0,-13.081 c 0,-1.269 -1.032,-2.3 -2.3,-2.3 l -3.256,0 c -1.269,0 -2.3,1.032 -2.3,2.3 l 0,13.08 c 0,1.269 1.032,2.301 2.3,2.301 z m -9.693,0 3.281,0 c 1.262,0 2.288,-1.026 2.288,-2.288 l 0,-7.012 c 0,-1.262 -1.026,-2.288 -2.288,-2.288 l -3.281,0 c -1.262,0 -2.288,1.026 -2.288,2.288 l 0,7.012 c 0,1.261 1.026,2.288 2.288,2.288 z",
                    "m 67.78,67.871 3.147,0 c 1.302,0 2.362,-1.06 2.362,-2.362 l 0,-31.018 c 0,-1.302 -1.06,-2.362 -2.362,-2.362 l -3.147,0 c -1.302,0 -2.362,1.06 -2.362,2.362 l 0,31.018 c 0,1.302 1.06,2.362 2.362,2.362 z m -0.362,-33.38 c 0,-0.2 0.162,-0.362 0.362,-0.362 l 3.147,0 c 0.2,0 0.362,0.162 0.362,0.362 l 0,31.018 c 0,0.2 -0.162,0.362 -0.362,0.362 l -3.147,0 c -0.2,0 -0.362,-0.162 -0.362,-0.362 l 0,-31.018 z m -9.378,33.38 3.266,0 c 1.266,0 2.295,-1.03 2.295,-2.295 l 0,-25.114 c 0,-1.266 -1.03,-2.296 -2.295,-2.296 l -3.266,0 c -1.266,0 -2.295,1.03 -2.295,2.296 l 0,25.113 c -10e-4,1.266 1.029,2.296 2.295,2.296 z M 57.744,40.462 c 0,-0.163 0.132,-0.296 0.295,-0.296 l 3.266,0 c 0.163,0 0.295,0.133 0.295,0.296 l 0,25.113 c 0,0.163 -0.132,0.295 -0.295,0.295 l -3.265,0 c -0.163,0 -0.295,-0.132 -0.295,-0.295 l 0,-25.113 z m -9.377,27.409 3.25,0 c 1.271,0 2.304,-1.033 2.304,-2.304 l 0,-19.097 c 0,-1.271 -1.033,-2.304 -2.304,-2.304 l -3.25,0 c -1.271,0 -2.304,1.034 -2.304,2.304 l 0,19.097 c 0,1.27 1.034,2.304 2.304,2.304 z m -9.684,0 3.256,0 c 1.269,0 2.301,-1.032 2.301,-2.3 l 0,-13.081 c 0,-1.269 -1.032,-2.3 -2.301,-2.3 l -3.256,0 c -1.269,0 -2.3,1.032 -2.3,2.3 l 0,13.08 c -0.001,1.269 1.031,2.301 2.3,2.301 z m -9.694,0 3.282,0 c 1.261,0 2.288,-1.026 2.288,-2.288 l 0,-7.012 c 0,-1.262 -1.026,-2.288 -2.288,-2.288 l -3.282,0 c -1.262,0 -2.288,1.026 -2.288,2.288 l 0,7.012 c 0,1.261 1.027,2.288 2.288,2.288 z",
                    "m 67.777,67.871 3.147,0 c 1.302,0 2.362,-1.06 2.362,-2.362 l 0,-31.018 c 0,-1.302 -1.06,-2.362 -2.362,-2.362 l -3.147,0 c -1.302,0 -2.362,1.06 -2.362,2.362 l 0,31.018 c 10e-4,1.302 1.06,2.362 2.362,2.362 z m -0.361,-33.38 c 0,-0.2 0.162,-0.362 0.362,-0.362 l 3.147,0 c 0.2,0 0.362,0.162 0.362,0.362 l 0,31.018 c 0,0.2 -0.162,0.362 -0.362,0.362 l -3.147,0 c -0.2,0 -0.362,-0.162 -0.362,-0.362 l 0,-31.018 z m -9.379,33.38 3.266,0 c 1.266,0 2.296,-1.03 2.296,-2.295 l 0,-25.114 c 0,-1.266 -1.03,-2.296 -2.296,-2.296 l -3.266,0 c -1.266,0 -2.295,1.03 -2.295,2.296 l 0,25.113 c 0,1.266 1.029,2.296 2.295,2.296 z m -9.672,0 3.25,0 c 1.271,0 2.304,-1.033 2.304,-2.304 l 0,-19.097 c 0,-1.271 -1.033,-2.304 -2.304,-2.304 l -3.25,0 c -1.271,0 -2.304,1.034 -2.304,2.304 l 0,19.097 c 0,1.27 1.033,2.304 2.304,2.304 z m -9.685,0 3.256,0 c 1.269,0 2.301,-1.032 2.301,-2.3 l 0,-13.081 c 0,-1.269 -1.032,-2.3 -2.301,-2.3 l -3.256,0 c -1.269,0 -2.3,1.032 -2.3,2.3 l 0,13.08 c 0,1.269 1.032,2.301 2.3,2.301 z m -9.693,0 3.282,0 c 1.261,0 2.288,-1.026 2.288,-2.288 l 0,-7.012 c 0,-1.262 -1.026,-2.288 -2.288,-2.288 l -3.282,0 c -1.261,0 -2.288,1.026 -2.288,2.288 l 0,7.012 c 0,1.261 1.027,2.288 2.288,2.288 z",
                    "m 67.775,67.871 3.148,0 c 1.302,0 2.362,-1.06 2.362,-2.362 l 0,-31.018 c 0,-1.302 -1.06,-2.362 -2.362,-2.362 l -3.148,0 c -1.302,0 -2.362,1.06 -2.362,2.362 l 0,31.018 c 0,1.302 1.06,2.362 2.362,2.362 z m -9.74,0 3.266,0 c 1.266,0 2.296,-1.03 2.296,-2.295 l 0,-25.114 c 0,-1.266 -1.03,-2.296 -2.296,-2.296 l -3.266,0 c -1.266,0 -2.296,1.03 -2.296,2.296 l 0,25.113 c 0,1.266 1.03,2.296 2.296,2.296 z m -9.673,0 3.25,0 c 1.271,0 2.304,-1.033 2.304,-2.304 l 0,-19.097 c 0,-1.271 -1.033,-2.304 -2.304,-2.304 l -3.25,0 c -1.271,0 -2.304,1.034 -2.304,2.304 l 0,19.097 c 10e-4,1.27 1.034,2.304 2.304,2.304 z m -9.684,0 3.257,0 c 1.269,0 2.3,-1.032 2.3,-2.3 l 0,-13.081 c 0,-1.269 -1.032,-2.3 -2.3,-2.3 l -3.257,0 c -1.269,0 -2.3,1.032 -2.3,2.3 l 0,13.08 c -10e-4,1.269 1.031,2.301 2.3,2.301 z m -9.694,0 3.282,0 c 1.262,0 2.288,-1.026 2.288,-2.288 l 0,-7.012 c 0,-1.262 -1.026,-2.288 -2.288,-2.288 l -3.282,0 c -1.261,0 -2.288,1.026 -2.288,2.288 l 0,7.012 c 10e-4,1.261 1.027,2.288 2.288,2.288 z"
                };
            }
        }

        private static void OnValueChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            OnValueChanged(d);
        }

        private static void OnValueChanged(DependencyObject d)
        {
            var indicator = d as StrengthIndicator;

            if (indicator == null) return;

            // var shape = (indicator.Content as Viewbox).Child; // Straightforward version.
            var shape = indicator.FindChild<Windows.UI.Xaml.Shapes.Path>("Shape");

            if (shape == null) return;

            var binding = new Binding
            {
                Source = indicator.Paths[indicator.Value + indicator._pathIndex]
            };

            BindingOperations.SetBinding(shape, Windows.UI.Xaml.Shapes.Path.DataProperty, binding);
        }

        private void StrengthIndicator_Loaded(object sender, RoutedEventArgs e)
        {
            Debug.WriteLine("Loaded with {0} Paths.", Paths.Count);

            OnValueChanged(this);
        }
    }

    static class DependencyObjectExtensions
    {
        /// <summary>
        /// Finds a Child of a given item in the visual tree. 
        /// </summary>
        /// <param name="parent">A direct parent of the queried item.</param>
        /// <typeparam name="T">The type of the queried item.</typeparam>
        /// <param name="childName">x:Name or Name of child. </param>
        /// <returns>The first parent item that matches the submitted type parameter. 
        /// If not matching item can be found, 
        /// a null parent is being returned.</returns>
        /// <remarks>
        /// http://stackoverflow.com/a/1759923/1188513
        /// </remarks>
        public static T FindChild<T>(this DependencyObject parent, string childName)
           where T : DependencyObject
        {
            if (parent == null) return null;

            T foundChild = null;

            var childrenCount = VisualTreeHelper.GetChildrenCount(parent);
            for (var i = 0; i < childrenCount; i++)
            {
                var child = VisualTreeHelper.GetChild(parent, i);
                var childType = child as T;
                if (childType == null)
                {
                    foundChild = FindChild<T>(child, childName);
                    if (foundChild != null) break;
                }
                else if (!string.IsNullOrEmpty(childName))
                {
                    var frameworkElement = child as FrameworkElement;
                    if (frameworkElement != null && frameworkElement.Name == childName)
                    {
                        foundChild = (T)child;
                        break;
                    }
                }
                else
                {
                    foundChild = (T)child;
                    break;
                }
            }

            return foundChild;
        }
    }
}
